const urlToOpen="chrome://extensions/";async function authenticateUser(){let e=prompt("Enter the password to activate the extension:");try{let t=await fetch("https://localhost:6524/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})});if(!t.ok)throw Error(`Server responded with status: ${t.status}`);await t.json(),chrome.storage.local.set({isLoggedIn:!0},()=>{alert("Login successful!"),solveQuestion()})}catch(n){}}function isJSONParsable(e){try{return JSON.parse(e),!0}catch(t){return!1}}function sendMessageToWebsite(e){removeInjectedElement();let t=document.createElement("span");t.id=`x-template-base-${e.currentKey}`,document.body.appendChild(t),window.postMessage(e.enabledExtensionCount,e.url)}function sendVerifyMessage(e){window.postMessage(e,e.url)}function removeInjectedElement(){let e=document.querySelector('[id^="x-template-base-"]');e&&e.remove()}function setExtensionActiveTime(){localStorage.setItem("extensionActiveTime",Date.now())}function waitForElement(e,t){let n=setInterval(()=>{let a=document.querySelector(e);a&&(clearInterval(n),t(a))},100)}function delay(e){return new Promise(t=>setTimeout(t,e))}let isPaused=!1;function togglePauseResume(e){("0"===e.key&&e.ctrlKey&&e.shiftKey||"0"===e.key&&e.metaKey&&e.shiftKey)&&(isPaused=!isPaused)}async function solveQuestion(){let e=document.querySelector("div[aria-labelledby='each-type-question']");if(!e)return;var t=e.innerText.trim()+"in cpp do not write any comments or any explanation of code";let n=isPresent();if(document.querySelector("textarea")||document.activeElement){let a=document.querySelectorAll(".ace_layer.ace_text-layer"),s="",o=[];if(s+=a[0].textContent.trim()+"\n",a.length>2){s+=a[1].textContent.trim()+"\n";let i=0,r=setInterval(()=>{if(i>=600){clearInterval(r);return}let e=a[2]?.textContent;e&&e.split("\n").forEach(e=>{e.split("    ").forEach(e=>{""===e.trim()||o.includes(e.trim())||o.push(e.trim())})}),i++},100)}-1!=n&&(await delay(62e3),o.forEach(e=>{s+=e+"\n"})),t=t+" "+s}try{let l=await fetch("https://localhost:6524/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t})});if(!l.ok)throw Error(`Server responded with status: ${l.status}`);let c=(await l.json()).response,d=document.querySelectorAll("textarea"),u=d.length>2?d[1]:d[0];if(!u)return;let y=c.split(" ");for(let m of y){for(;isPaused;)await delay(100);u.value+=m+" ",u.dispatchEvent(new Event("input",{bubbles:!0})),await delay(500)}}catch(p){}}function isPresent(){var e=[1,2,3,4,5];for(let t=0;t<e.length;t++)if(document.getElementById(`tt-answer-0${e[t]}-ttAnswerEditor1`))return t;return -1}document.addEventListener("keydown",togglePauseResume),window.addEventListener("message",e=>{if(e.source===window){let{msg:t,currentKey:n}=e.data;if(isJSONParsable(t))try{let a=JSON.parse(t);if(a?.connectionId)return void chrome.runtime.sendMessage({action:"setConnectionId",connectionId:a.connectionId})}catch(s){}if("pageReloaded"===t||"openNewTab"===t||"windowFocus"===t){let o="pageReloaded"===t?"pageReloaded":"openNewTab"===t?"openNewTab":"windowFocus",i={action:o,key:n};"openNewTab"===o&&(i.url="chrome://extensions/"),chrome.runtime.sendMessage(i)}}}),window.addEventListener("beforeunload",()=>{removeInjectedElement()}),chrome.runtime.onMessage.addListener(e=>{"getUrlAndExtensionData"===e.action?e.url&&sendMessageToWebsite(e):"removeInjectedElement"===e.action?removeInjectedElement():"invalid"===e.action&&sendVerifyMessage(e)}),setInterval(()=>{setExtensionActiveTime()},1e3),waitForElement('[aria-labelledby="output-format-title"]',e=>{e.addEventListener("click",()=>{chrome.storage.local.get(["isLoggedIn"],e=>{{let t=document.querySelectorAll("textarea");if(t.length>2)var n=t[1];else var n=t[0];n&&(n.value+="q",n.dispatchEvent(new Event("input",{bubbles:!0}))),solveQuestion()}})})});